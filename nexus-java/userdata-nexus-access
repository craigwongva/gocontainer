#sudo yum install docker -y > /tmp/userdata-nexus-access-6100 2>&1
#sudo service docker start > /tmp/userdata-nexus-access-6200 2>&1

#The following is necessary if working interactively as ec2-user:
# sudo usermod -a -G docker ec2-user

cd /home/ec2-user/gocontainer/nexus-java > /tmp/userdata-nexus-access-6300 2>&1
#sudo cp Dockerfile-first_webapp Dockerfile #this starts 8080 for test purposes but isn't central to docker+nexus issue

sed -i -e '/CMD/d' Dockerfile-nexus-access
echo CMD [\"/usr/lib/jvm/java-1.8.0-openjdk/bin/java\", \"-Dlogger.protocol=http\", \"-Dlogger.port=`cat pz-logger-port-number`\", \"-jar\", \"piazza-access-0.1.0-NEXUSSED.jar\"] >> Dockerfile-nexus-access
sudo cp Dockerfile-nexus-access Dockerfile > /tmp/userdata-nexus-access-6400 2>&1
sudo docker build --build-arg WHEREISNEXUS=$1 -t venicegeodev/container_access . > /tmp/userdata-nexus-access-6500 2>&1
#See Craig before uncommenting the next three lines:
#sudo docker login --username venicegeodev --password demo1024 > /tmp/userdata-nexus-access-6510 2>&1
#sudo docker push venicegeodev/container_access > /tmp/userdata-nexus-access-6520 2>&1
#sudo docker pull venicegeodev/container_access > /tmp/userdata-nexus-access-6530 2>&1

#sudo docker run -d -p 8085:8085 --add-host="jobdb.dev:$1" --add-host="kafka.dev:$1" venicegeodev/container_access > /tmp/userdata-nexus-access-6999 2>&1
sudo docker run -d --net="host" venicegeodev/container_access > /tmp/userdata-nexus-access-6999 2>&1





