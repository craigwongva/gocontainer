#sudo yum install docker -y > /tmp/8100 2>&1
#sudo service docker start > /tmp/8200 2>&1

#The following is necessary if working interactively as ec2-user:
# sudo usermod -a -G docker ec2-user

cd /home/ec2-user/gocontainer/nexus-java > /tmp/8300 2>&1
#sudo cp Dockerfile-first_webapp Dockerfile #this starts 8080 for test purposes but isn't central to docker+nexus issue
sudo cp Dockerfile-nexus-gateway Dockerfile > /tmp/8400 2>&1
sudo docker build --build-arg WHEREISNEXUS=$1 -t venicegeodev/container_gateway . > /tmp/8500 2>&1
sudo docker login --username venicegeodev --password demo1024 > /tmp/8510 2>&1
sudo docker push venicegeodev/container_gateway > /tmp/8520 2>&1
sudo docker pull venicegeodev/container_gateway > /tmp/8530 2>&1
#The following is necessary only for pz-gateway, which by default uses :8081 like Nexus:
/home/ec2-user/gocontainer/nexus-3.0.0-03/bin/nexus stop > /tmp/8540 2>&1
sudo docker run -d -p 8081:8081 --add-host="localhost:$1" venicegeodev/container_gateway > /tmp/8600 2>&1
